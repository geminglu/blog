KEEP.initUtils=()=>{KEEP.utils={rootHtmlDom:document.querySelector("html"),pageTopDom:document.querySelector(".page-main-content-top"),scrollProgressBarDom:document.querySelector(".scroll-progress-bar"),pjaxProgressBarDom:document.querySelector(".pjax-progress-bar"),pjaxProgressIcon:document.querySelector(".pjax-progress-icon"),back2TopBtn:document.querySelector(".tool-scroll-to-top"),headerWrapperDom:document.querySelector(".header-wrapper"),innerHeight:window.innerHeight,pjaxProgressBarTimer:null,prevScrollValue:0,fontSizeLevel:0,isHasScrollProgressBar:!1,isHasScrollPercent:!1,isHeaderTransparent:!1,hasToc:!1,initData(){var{scroll:e,first_screen:t}=KEEP.theme_config?.style||{},{enable:e,header_transparent:t}=(this.isHasScrollProgressBar=!0===e?.progress_bar,this.isHasScrollPercent=!0===e?.percent,t||{});this.isHeaderTransparent=!0===e&&!0===t&&!window.location.pathname.includes("/page/"),this.isHeaderTransparent||this.headerWrapperDom.classList.remove("transparent-1","transparent-2")},styleHandleWhenScroll(){var e=document.body.scrollTop||document.documentElement.scrollTop,t=document.body.scrollHeight||document.documentElement.scrollHeight,o=window.innerHeight||document.documentElement.clientHeight,s=Math.round(e/(t-o)*100)||0;10<e?this.back2TopBtn.classList.add("show"):this.back2TopBtn.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBarDom&&(t=(e/(t-o)*100).toFixed(3),this.scrollProgressBarDom.style.visibility=0===s?"hidden":"visible",this.scrollProgressBarDom.style.width=t+"%"),this.isHasScrollPercent&&this.back2TopBtn&&(this.back2TopBtn.classList.add("show-percent"),o=this.back2TopBtn.querySelector(".percent"),0===s||void 0===s?this.back2TopBtn.classList.remove("show"):(this.back2TopBtn.classList.add("show"),o.innerHTML=s.toFixed(0),99<s?this.back2TopBtn.classList.add("show-arrow"):this.back2TopBtn.classList.remove("show-arrow"))),e>this.prevScrollValue&&e>this.innerHeight?(this.pageTopDom.classList.add("hide"),this.isHeaderTransparent&&this.headerWrapperDom.classList.remove("transparent-1","transparent-2")):(this.pageTopDom.classList.remove("hide"),this.isHeaderTransparent&&(e<=this.headerWrapperDom.getBoundingClientRect().height?(this.headerWrapperDom.classList.remove("transparent-2"),this.headerWrapperDom.classList.add("transparent-1")):e<this.innerHeight&&this.headerWrapperDom.classList.add("transparent-2"))),this.prevScrollValue=e},registerWindowScroll(){window.addEventListener("scroll",()=>{this.styleHandleWhenScroll(),!0===KEEP.theme_config?.toc?.enable&&KEEP.utils?.tocHelper&&KEEP.utils.tocHelper.activeNav(),KEEP.utils.headerShrink.headerShrink(),KEEP.utils.headerShrink.sideToolsBarShowHandle()})},toggleShowToolsList(){const t=document.querySelector(".side-tools-list");document.querySelector(".tool-toggle-show").addEventListener("click",e=>{t.classList.toggle("show"),e.stopPropagation()}),t.querySelectorAll(".tools-item").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation()})}),document.addEventListener("click",()=>{t.classList.contains("show")&&t.classList.remove("show")})},globalFontAdjust(){var e=document.defaultView.getComputedStyle(document.body).fontSize;const t=parseFloat(e);const o=e=>{this.rootHtmlDom.style.setProperty("font-size",t*(1+.05*e)+"px","important"),KEEP.styleStatus.fontSizeLevel=e,KEEP.setStyleStatus()};(e=KEEP.getStyleStatus())&&(this.fontSizeLevel=e.fontSizeLevel,o(this.fontSizeLevel)),document.querySelector(".tool-font-adjust-plus").addEventListener("click",()=>{5!==this.fontSizeLevel&&(this.fontSizeLevel++,o(this.fontSizeLevel))}),document.querySelector(".tool-font-adjust-minus").addEventListener("click",()=>{this.fontSizeLevel<=0||(this.fontSizeLevel--,o(this.fontSizeLevel))})},initHasToc(){0<document.querySelectorAll(".post-toc-wrap .post-toc li").length?(this.hasToc=!0,document.body.classList.add("has-toc")):(this.hasToc=!1,document.body.classList.remove("has-toc"))},zoomInImage(){let d=40,h=!1,u=0,m=null;var e=document.querySelectorAll(".keep-markdown-body img");const g=document.querySelector(".zoom-in-image-mask"),p=g?.querySelector(".zoom-in-image"),t=()=>{h&&(h=!1,u=0,p&&(p.style.transform="scale(1)"),g&&g.classList.remove("show"),setTimeout(()=>{m&&m.classList.remove("hide")},300))};e.length&&(g&&g.addEventListener("click",()=>{t()}),document.addEventListener("scroll",()=>{h&&50<=Math.abs(u-window.scrollY)&&t()}),e.forEach(c=>{c.addEventListener("click",()=>{var e,t,o,s,r,a,i,l,n;u=window.scrollY,h=!h,e=document.body.offsetWidth,d=e<=500?10:e<=800?20:40,p.setAttribute("src",c.getAttribute("src")),m=c,h&&(t=(e=m.getBoundingClientRect()).width,o=e.height,s=e.left,r=e.top,i=((i=(n=document.body.offsetWidth-2*d)/t)<(l=(a=document.body.offsetHeight-2*d)/o)?i:l)||1,l=n/2-(e.x+t/2)+d,n=a/2-(e.y+o/2)+d,m.classList.add("hide"),g.classList.add("show"),p.style.top=r+"px",p.style.left=s+"px",p.style.width=t+"px",p.style.height=o+"px",p.style.transform=`translateX(${l}px) translateY(${n}px) scale(${i}) `)})}))},setHowLongAgoLanguage(e,t){return t.replace(/%s/g,e)},getHowLongAgo(e){var t=KEEP.language_ago,o=Math.floor(e/2592e3/12),s=Math.floor(e/2592e3),r=Math.floor(e/86400/7),a=Math.floor(e/86400),i=Math.floor(e/3600%24),l=Math.floor(e/60%60),e=Math.floor(e%60);return 0<o?this.setHowLongAgoLanguage(o,t.year):0<s?this.setHowLongAgoLanguage(s,t.month):0<r?this.setHowLongAgoLanguage(r,t.week):0<a?this.setHowLongAgoLanguage(a,t.day):0<i?this.setHowLongAgoLanguage(i,t.hour):0<l?this.setHowLongAgoLanguage(l,t.minute):0<e?this.setHowLongAgoLanguage(e,t.second):void 0},setHowLongAgoInHome(){var e=document.querySelectorAll(".article-meta-info .home-article-history");e&&e.forEach(e=>{var t=Date.now(),o=new Date(e.dataset.updated).getTime();e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3))})},pjaxProgressBarStart(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.isHasScrollProgressBar&&this.scrollProgressBarDom.classList.add("hide"),this.pjaxProgressBarDom.style.width="0",this.pjaxProgressIcon.classList.add("show");let e=1;this.pjaxProgressBarDom.classList.add("show"),this.pjaxProgressBarDom.style.width=e+"%",this.pjaxProgressBarTimer=setInterval(()=>{99<(e+=5)&&(e=99),this.pjaxProgressBarDom.style.width=e+"%"},100)},pjaxProgressBarEnd(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer),this.pjaxProgressBarDom.style.width="100%";const t=setTimeout(()=>{this.pjaxProgressBarDom.classList.remove("show"),this.pjaxProgressIcon.classList.remove("show"),this.isHasScrollProgressBar&&this.scrollProgressBarDom.classList.remove("hide");const e=setTimeout(()=>{this.pjaxProgressBarDom.style.width="0",clearTimeout(t),clearTimeout(e)},200)},200)},insertTooltipContent(){const p=!0===KEEP.theme_config?.lazyload?.enable,e=()=>{document.querySelectorAll(".tooltip").forEach(e=>{var{tooltipContent:t,tooltipOffsetX:o,tooltipOffsetY:s}=e.dataset;let r="";o&&(r+=`left: ${o};`),s&&(r+=`top: ${s};`),r=r&&`style="${r}"`,t&&e.insertAdjacentHTML("afterbegin",`<span class="tooltip-content" ${r}>${t}</span>`)});const g={};document.querySelectorAll(".tooltip-img").forEach((r,t)=>{var o,s,{tooltipImgName:a,tooltipImgUrl:i,tooltipImgTip:l,tooltipImgTrigger:n="click",tooltipImgStyle:c}=r.dataset;let d="",h=(c&&(d=`style="${c}"`),"");if(l&&(h=`<div class="tip">${l}</div>`),i){const u=`tooltip-img-${t}-`+(a||Date.now()),m=a+"-"+t;c=`<img class="${u}"
                              ${p?"lazyload":""}
                              ${p?"data-":""}src="${i}"
                              alt="${u}"
                            >`,l=`<div ${d} class="tooltip-img-box ${h?"has-tip":""}">${c}${h}</div>`;g[m]={imgLoaded:!1,isShowImg:!1},r.insertAdjacentHTML("afterbegin",l);let e="hover"===n?"mouseover":"click";r.addEventListener(e,e=>{if(p&&!g[m].imgLoaded){var t=document.querySelector(".tooltip-img-box img."+u);g[m].imgLoaded;var o=new Image;const s=t.dataset["src"];o.src=s,o.onload=()=>{t.src=s,t.removeAttribute("lazyload")}}g[m].isShowImg=!g[m].isShowImg,r.classList.toggle("show-img"),e.stopPropagation()}),[o,s,a="click"]=[r,m,n],"hover"===a&&(a="mouseout"),document.addEventListener(a,()=>{g[s].isShowImg&&(o.classList.remove("show-img"),g[s].isShowImg=!1)})}})};setTimeout(()=>{e()},1e3)},siteCountInitialize(){if(!0===KEEP.theme_config?.website_count?.busuanzi_count?.enable){var t="busuanzi-js";let e=document.body.querySelector("#"+t);e||((e=document.createElement("script")).setAttribute("data-pjax",""),e.setAttribute("id",t),e.async=!0,e.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",document.body.appendChild(e));const s=e=>document.querySelector(e)?.innerText;e.onload=()=>{setTimeout(()=>{var e,t,o;(s("#busuanzi_value_site_uv")||s("#busuanzi_value_site_pv")||s("#busuanzi_value_page_pv"))&&(e=document.querySelector(".footer .count-item .uv"),t=document.querySelector(".footer .count-item .pv"),o=document.querySelector(".article-meta-info .article-pv"),e&&(e.style.display="flex"),t&&(t.style.display="flex"),o)&&(o.style.display="inline-block")},1e3)}}},pageNumberJump(){const s=document.querySelector(".paginator .page-number-input");s&&s.addEventListener("change",e=>{var t=Number(e.target.max);let o=Number(e.target.value);o<=0&&(s.value=1,o=1),o>t&&(s.value=t,o=t);e=window.location.href.replace(/\/$/,"").split("/page/")[0];1===o?window.location.href=e:window.location.href=e+"/page/"+o})},tabsActiveHandle(){var e=document.querySelectorAll(".keep-tabs");e.length&&e.forEach(e=>{const r=e.querySelectorAll(".tabs-nav .tab"),a=e.querySelectorAll(".tabs-content .tab-pane");r.forEach(s=>{s.addEventListener("click",()=>{var e,t,o;e=r,t=a,o=s,e.forEach(e=>{o.dataset.href===e.dataset.href?e.classList.add("active"):e.classList.remove("active")}),t.forEach(e=>{o.dataset.href===e.id?e.classList.add("active"):e.classList.remove("active")})})})})},initTypewriter(){var e=KEEP.theme_config?.style?.first_screen||{},t=!0===e?.hitokoto;if(!0===e?.enable&&(!0!==e?.enable||t||e?.description)){const o=document.querySelector(".first-screen-content .description");o&&(o.style.opacity="0",setTimeout(()=>{o.style.opacity="1",o.querySelectorAll(".desc-item").forEach(e=>{const t=e.querySelector(".desc"),o=e.querySelector(".cursor"),s=t.innerHTML;t.innerHTML="";let r=0;if(s){const a=()=>{r<s.length?(t.textContent+=s.charAt(r),r++,setTimeout(a,100)):o.style.display="none"};a()}})},t?400:300))}}},KEEP.utils.initData(),KEEP.utils.registerWindowScroll(),KEEP.utils.toggleShowToolsList(),KEEP.utils.globalFontAdjust(),KEEP.utils.initHasToc(),KEEP.utils.zoomInImage(),KEEP.utils.setHowLongAgoInHome(),KEEP.utils.insertTooltipContent(),KEEP.utils.siteCountInitialize(),KEEP.utils.pageNumberJump(),KEEP.utils.tabsActiveHandle(),KEEP.utils.initTypewriter()};